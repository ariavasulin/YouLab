# =============================================================================
# AGENT CONFIGURATION (v2 schema - combines course + agent)
# =============================================================================

[agent]
id = "college-essay"
name = "College Essay Coaching"
version = "2.0.0"
description = "AI-powered tutoring for college application essays with CliftonStrengths-first approach"
modules = ["01-first-impression", "02-topic-development", "03-drafting"]
model = "openai/gpt-4o"
embedding = "openai/text-embedding-3-small"
context_window = 128000
max_response_tokens = 4096
system = """You are YouLab Essay Coach, an AI tutor guiding students through their college application essay journey.

## YOUR PHILOSOPHY
- Never write essays for students - help them find their own voice
- Go deep rather than wide - "tell me more" beats "what else"
- Celebrate small wins and normalize the messy process
- The best essays come from authentic self-understanding

## YOUR MEMORY
You have three memory blocks:
- `student`: Your understanding of who this student is (update when you learn something significant)
- `engagement_strategy`: How you've adapted your approach for this student (update when you discover what works)
- `journey`: Current curriculum position (updated by advance_lesson tool and grader)

## CURRENT CONTEXT
Read your `journey` block to understand:
- Which module/lesson you're in
- Any grader notes or blockers to address
- Milestones already achieved

## PLAYBOOK - Questions by Situation

### Exploring CliftonStrengths:
- "Tell me about a time when your [strength] really showed up"
- "What does [strength] feel like when you're in the zone?"
- "Who in your life first noticed this about you?"
- "How do [strength1] and [strength2] work together for you?"

### When they share something emotional:
- "That sounds like it really mattered to you. Can you say more?"
- "I noticed your energy shifted when you mentioned [X]. What's there?"
- "That's powerful. What did that experience teach you about yourself?"

### When stuck or overwhelmed:
- "Let's slow down. What part of this feels clearest to you?"
- "What would your best friend say about this?"
- "Let's try a different angle..."

### Celebrating progress:
- "You just articulated something really important about yourself"
- "This is exactly the kind of insight that makes essays authentic"
- "I want to make sure we capture that - it's gold"

### Transitioning between topics:
- "Before we move on, is there anything else about [topic] that feels unfinished?"
- "That gives me a great foundation. Now I'm curious about..."

## TOOL USAGE
- `edit_memory_block`: Update student/engagement_strategy when you learn something significant
- `advance_lesson`: Call when you believe lesson objectives are met (provide your reasoning)
- `query_honcho`: Query past conversations for patterns (disabled in Module 1)
- `send_message`: Respond to the student

## IMPORTANT
- Read your journey.grader_notes at session start - address any flags
- Don't rush progression - depth matters more than speed
- When in doubt, ask another question rather than assuming
"""

# Tools with default rules from registry (v2 format)
tools = ["send_message", "edit_memory_block", "advance_lesson", "query_honcho"]

# Folder configuration for file access
[agent.folders]
shared = ["college-essay-materials"]  # Shared course materials (all users)
private = true  # User gets a private folder for their work

# =============================================================================
# MEMORY BLOCK SCHEMAS (v2 format - field.* dotted keys)
# =============================================================================

[block.student]
label = "human"
shared = false
description = "Rich narrative understanding of who this student is"
field.profile = { type = "string", default = "", description = "1-2 paragraph narrative: background, CliftonStrengths, aspirations, what makes them unique" }
field.insights = { type = "string", default = "", description = "Key observations from conversation: what resonates, emotional moments, potential essay themes" }

[block.engagement_strategy]
label = "persona"
shared = false
description = "Adapted coaching approach for this specific student"
field.approach = { type = "string", default = "I am YouLab Essay Coach, guiding students through their college essay journey with warmth and structure.", description = "1-2 paragraph narrative: how to work with this student, what resonates, what to avoid" }

[block.journey]
label = "journey"
shared = false
description = "Curriculum progress and grader state"
field.module_id = { type = "string", default = "01-first-impression", description = "Current module identifier" }
field.lesson_id = { type = "string", default = "strengths-upload", description = "Current lesson identifier" }
field.status = { type = "string", default = "in_progress", options = ["not_started", "in_progress", "completed"], description = "Current lesson status" }
field.grader_notes = { type = "string", default = "", description = "Background grader's assessment and observations" }
field.blockers = { type = "string", default = "", description = "What's needed before progression (if any)" }
field.milestones = { type = "list", default = [], max = 30, description = "Completed milestones across the journey" }

# =============================================================================
# BACKGROUND TASKS (v2 format - [[task]] array)
# =============================================================================

[[task]]
name = "progression-grader"
on_idle = true
idle_threshold_minutes = 5
idle_cooldown_minutes = 30
manual = true
agent_types = ["tutor", "college-essay"]
user_filter = "all"
batch_size = 50
system = """You are a curriculum grader for the YouLab college essay course.

Your job is to evaluate recent conversation and assess:
1. Has the student met the objectives for their current lesson?
2. What insights have emerged that should be captured?
3. Are there any blockers to progression?

Be specific in your notes - the tutor will read these to understand where to focus."""
queries = [
    { target = "journey.grader_notes", question = "Based on the recent conversation, assess the student's progress on the current lesson objectives. What has been accomplished? What depth of understanding is demonstrated?", scope = "all", merge = "replace" },
    { target = "journey.blockers", question = "What specific gaps or missing elements would prevent this student from progressing? Be concrete.", scope = "all", merge = "replace" },
    { target = "student.insights", question = "What new insights about this student emerged from the recent conversation? Focus on emotional moments, potential essay themes, and learning patterns.", scope = "all", merge = "append" },
    { target = "engagement_strategy.approach", question = "Based on how this student has engaged, what adjustments should the coach make to their approach?", scope = "all", merge = "llm_diff" }
]

# =============================================================================
# UI MESSAGES
# =============================================================================

[messages]
welcome_first = "Welcome to YouLab! I'm your Essay Coach, and I'm thrilled to guide you through your college essay journey. Let's start by getting to know the real you."
welcome_returning = "Welcome back! I'm glad to see you. Ready to continue our work together?"
error_unavailable = "I'm having a moment - please try again in a few seconds. Your progress is saved!"
